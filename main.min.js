var ApiService=function(){function t(){this.urlloader=new egret.URLLoader,this.urlloader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this)}var e=(__define,t),i=e.prototype;return i.onLoadError=function(t){alert("出现错误，请稍后再试")},t.instance=function(){return null==this._instance&&(this._instance=new t),this._instance},i.post=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=null),egret.MainContext.instance.stage.addChild(Spinner.instance());var n=new egret.URLRequest;n.method=egret.URLRequestMethod.POST;var s=[];for(var a in e)s.push(a+"="+e[a]);s.length&&(n.data=new egret.URLVariables(s.join("&"))),n.url=t+"&_r="+Math.random(),this.urlloader.load(n);var h=function(){egret.MainContext.instance.stage.removeChild(Spinner.instance());var t=JSON.parse(this.urlloader.data);i&&i(t),this.urlloader.removeEventListener(egret.Event.COMPLETE,h,this)};this.urlloader.addEventListener(egret.Event.COMPLETE,h,this)},t}();egret.registerClass(ApiService,"ApiService");var Missile=function(t){function e(){t.call(this),this.createBitmap()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createBitmap=function(){this.addChild(Utils.createBitmap(this.getAssetName()))},e}(egret.Sprite);egret.registerClass(Missile,"Missile");var Bomb=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.getAssetName=function(){return"fruit1_png"},e}(Missile);egret.registerClass(Bomb,"Bomb");var Clock=function(t){function e(e){void 0===e&&(e=30),t.call(this),this.time=e,this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){this.textField=new egret.TextField,this.textField.bold=!0,this.textField.italic=!0,this.textField.textColor=14354247,this.textField.size=28,this.textField.text="00:"+(this.time>9?this.time:"0"+this.time),this.addChild(this.textField),this.x=514,this.y=442},n.start=function(){this.timer=new egret.Timer(1e3,this.time),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer.start()},n.restart=function(){this.textField.text="00:"+(this.time>9?this.time:"0"+this.time),this.start()},n.stop=function(){this.timer.stop()},n.timerFunc=function(t){var e=t.target.currentCount,i=this.time-e;this.textField.text="00:"+(i>9?i:"0"+i)},n.timerComFunc=function(t){this.dispatchEventWith("timeUp")},e}(egret.Sprite);egret.registerClass(Clock,"Clock");var CodeGiftPanel=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight;this._panel=new egret.Sprite;var i=Utils.createBitmap("panel_png");this._panel.addChild(i),this._panel.x=(t-this._panel.width)/2,this._panel.y=(e-this._panel.height)/2,this.addChild(this._panel);var n=new egret.TextField;n.bold=!0,n.textColor=16777215,n.size=36,n.text="恭喜你！",n.textAlign="center",n.width=464,n.y=90,n.fontFamily="Microsoft YaHei",this._panel.addChild(n);var s=new egret.TextField;s.textColor=16777215,s.size=24,s.textAlign="center",s.text="获得由易果生鲜提供的优惠券一份\r\n快去感受新鲜果味吧！\r\n请保存该优惠码",s.width=464,s.y=140,s.lineSpacing=10,s.fontFamily="Microsoft YaHei",this._panel.addChild(s);var a=new egret.TextField;a.bold=!0,a.textColor=16438338,a.size=36,a.textAlign="center",a.text="YGXM0001A",a.width=464,a.y=250,a.fontFamily="Microsoft YaHei",this._panel.addChild(a);var h=new egret.TextField;h.textColor=16777215,h.size=24,h.textAlign="center",h.text="于易果网结算时输入代码使用。",h.width=464,h.y=305,h.fontFamily="Microsoft YaHei",this._panel.addChild(h);var r=Utils.createBitmap("instruction_png");r.x=171,r.y=352,r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.instruction,this),this._panel.addChild(r),this.graphics.beginFill(0,.67),this.graphics.drawRect(0,0,t,e),this.graphics.endFill();var o=new egret.Sprite,d=Utils.createBitmap("playAgin2_png");o.addChild(d),o.x=76,o.y=495,o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playAgain,this),this._panel.addChild(o);var l=new egret.Sprite,d=Utils.createBitmap("buy_png");l.addChild(d),l.x=76,l.y=422,l.touchEnabled=!0,l.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toBuy,this),this._panel.addChild(l),this.codeInstructionPanel=new CodeInstructionPanel,this.touchEnabled=!0},n.playAgain=function(){this.dispatchEventWith("playAgain"),this.close()},n.toBuy=function(){window.location.href="http://login.m.yiguo.com/register?utm_source=1016041501&utm_medium=xuanmai"},n.close=function(){this.parent.removeChild(this)},n.instruction=function(){this.addChild(this.codeInstructionPanel)},e}(egret.Sprite);egret.registerClass(CodeGiftPanel,"CodeGiftPanel");var CodeInstructionPanel=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight;this._panel=new egret.Sprite;var i=Utils.createBitmap("panel_png");this._panel.addChild(i),this._panel.x=(t-this._panel.width)/2,this._panel.y=(e-this._panel.height)/2,this.addChild(this._panel);var n=Utils.createBitmap("instructionContent_png");n.x=47,n.y=77,this._panel.addChild(n),this.graphics.beginFill(0,.67),this.graphics.drawRect(0,0,t,e),this.graphics.endFill();var s=new egret.Sprite,a=Utils.createBitmap("closeBtn_png");s.addChild(a),s.x=76,s.y=490,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this),this._panel.addChild(s),this.touchEnabled=!0},n.close=function(){this.parent.removeChild(this)},e}(egret.Sprite);egret.registerClass(CodeInstructionPanel,"CodeInstructionPanel");var Count=function(t){function e(){t.call(this),this.count=0,this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){this.textField=new egret.TextField,this.textField.text=":"+(this.count>9?this.count:"0"+this.count),this.textField.bold=!0,this.textField.italic=!0,this.textField.textColor=16473942,this.textField.size=54,this.addChild(this.textField),this.x=517,this.y=575},n.update=function(){this.textField.text=":"+(this.count>9?this.count:"0"+this.count)},n.add=function(){this.count++,this.update()},n.reset=function(){this.count=0,this.update()},n.getVal=function(){return this.count},e}(egret.Sprite);egret.registerClass(Count,"Count");var Countdown=function(t){function e(){t.call(this),this.createView(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.addToStage=function(){this.createTimer();var t=RES.getRes("countTime_mp3"),e=t.play(0,1);e.addEventListener(egret.Event.SOUND_COMPLETE,function(){var t=RES.getRes("begin_mp3");t.play(0,1)},this)},n.createView=function(){this.time=new egret.Bitmap,this.time.texture=RES.getRes("time3_png"),this.addChild(this.time);var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight;this.x=(t-this.width)/2,this.y=(e-this.height)/2},n.createTimer=function(){this.timer=new egret.Timer(1e3,4),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer.start()},n.timerFunc=function(t){var e=t.target.currentCount;4>e&&(this.time.texture=RES.getRes("time"+(3-e)+"_png"))},n.timerComFunc=function(t){this.parent.removeChild(this),this.dispatchEventWith("go")},e}(egret.Sprite);egret.registerClass(Countdown,"Countdown");var Export=function(t){function e(){t.call(this),this.places=[{x:86,y:220},{x:291,y:94},{x:510,y:148}],this.speed=4e3,this.missilePool=[],this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){this.missileLayer=new egret.DisplayObjectContainer,this.addChild(this.missileLayer),this.createBg()},n.createBg=function(){var t=Utils.createBitmap("pipe_png");this.addChild(t)},n.getMissilePool=function(){return this.missilePool},n.start=function(){this.emit(),this.timer=new egret.Timer(600),this.timer.addEventListener(egret.TimerEvent.TIMER,this.emit,this),this.timer.start()},n.stop=function(){this.timer.stop()},n.emit=function(){var t=Utils.random(0,10),e=null;e=6>=t?new Mango:8>=t?new Grape:new Bomb;var i=Utils.random(0,2);e.x=this.places[i].x,e.y=this.places[i].y,this.missileLayer.addChild(e),this.missilePool.push(e);var n=(this.stage.stageHeight-e.y)/this.stage.stageHeight*this.speed;egret.Tween.get(e).to({y:this.stage.stageHeight},n).call(function(t){this.removeMissile(t)},this,[e])},n.removeMissile=function(t){this.missileLayer.removeChild(t),this.missilePool.splice(this.missilePool.indexOf(t),1)},e}(egret.Sprite);egret.registerClass(Export,"Export");var Game=function(t){function e(){t.call(this),this.createView(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.addToStage=function(){var t=RES.getRes("music1_mp3");t.play()},n.createView=function(){var t=Utils.createBitmap("game_jpg");this.addChild(t),this.clock=new Clock(30),this.addChild(this.clock),this.clock.addEventListener("timeUp",this.timeUp,this),this.count=new Count,this.addChild(this.count),this.operationPanel=new OperationPanel,this.addChild(this.operationPanel),this.operationPanel.addEventListener("add",this.addCount,this),this.operationPanel.addEventListener("gameover",this.gameover,this),this["export"]=new Export,this.addChild(this["export"]),this.countdown=new Countdown,this.countdown.addEventListener("go",this.start,this),this.gameoverPanel=new GameoverPanel,this.gameoverPanel.addEventListener("playAgain",this.restart,this),this.timeupPanel=new TimeupPanel,this.timeupPanel.addEventListener("playAgain",this.restart,this),this.timeupPanel.addEventListener("getGift",this.getGift,this),this.rulePanel=new RulePanel,this.rulePanel.addEventListener("closeRule",this.closeRule,this),this.codeGiftPanel=new CodeGiftPanel,this.codeGiftPanel.addEventListener("playAgain",this.restart,this),this.wechatGiftPanel=new WechatGiftPanel,this.wechatGiftPanel.addEventListener("playAgain",this.restart,this),this.wechatGiftPanel.addEventListener("getTicket",this.getTicket,this),this.noGiftPanel=new NoGiftPanel,this.noGiftPanel.addEventListener("playAgain",this.restart,this),this.addChild(this.rulePanel)},n.closeRule=function(){this.addChild(this.countdown)},n.start=function(){console.log("start"),this["export"].start(),this.clock.start()},n.timeUp=function(){console.log("timeUp"),this.timeupPanel.setResult(this.count.getVal()),this.addChild(this.timeupPanel),this["export"].stop()},n.gameover=function(){console.log("gameover"),this.addChild(this.gameoverPanel),this["export"].stop(),this.clock.stop()},n.getExport=function(){return this["export"]},n.restart=function(){this.count.reset(),this["export"].start(),this.clock.restart()},n.addCount=function(){this.count.add(),this.timeupPanel.setResult(this.count.getVal())},n.getGift=function(){var t=this;ApiService.instance().post("./core/api.php?act=lucky",{score:this.count.getVal()},function(e){if("0"==e.error){t.removeChild(t.timeupPanel);var i=e.data.key;1==i||2==i?t.addChild(t.wechatGiftPanel):3==i?t.addChild(t.codeGiftPanel):t.addChild(t.noGiftPanel)}else alert(e.message)})},n.getTicket=function(){ApiService.instance().post("./core/api.php?act=getTicket",{},function(t){"0"==t.error?wx.addCard({cardList:[{cardId:t.data.card_id,cardExt:t.data.card_ext}],success:function(t){ApiService.instance().post("./core/api.php?act=ticketstatus")},error:function(t){ApiService.instance().post("./core/api.php?act=error",{data:t})}}):alert(t.message)})},e}(egret.DisplayObjectContainer);egret.registerClass(Game,"Game");var GameoverPanel=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight;this._panel=new egret.Sprite;var i=Utils.createBitmap("panel_png");this._panel.addChild(i),this._panel.x=(t-this._panel.width)/2,this._panel.y=(e-this._panel.height)/2,this.addChild(this._panel);var n=Utils.createBitmap("gameover_png");n.x=60,n.y=70,this._panel.addChild(n),this.graphics.beginFill(0,.67),this.graphics.drawRect(0,0,t,e),this.graphics.endFill();var s=new egret.Sprite,a=Utils.createBitmap("playAgin_png");s.addChild(a),s.x=76,s.y=402,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playAgain,this),this._panel.addChild(s);var h=new egret.Sprite,r=Utils.createBitmap("shareFriend_png");h.addChild(r),h.x=76,h.y=475,h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareFriend,this),this._panel.addChild(h),this.sharePanel=new SharePanel,this.touchEnabled=!0},n.playAgain=function(){this.dispatchEventWith("playAgain"),this.close()},n.shareFriend=function(){this.addChild(this.sharePanel)},n.close=function(){this.parent.removeChild(this)},e}(egret.Sprite);egret.registerClass(GameoverPanel,"GameoverPanel");var Grape=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.getAssetName=function(){return"fruit2_png"},e}(Missile);egret.registerClass(Grape,"Grape");var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){var t=Utils.createBitmap("load_jpg");this.addChild(t);var e=Utils.createBitmap("wheelDown_png");e.x=179,e.y=609,this.addChild(e),this.wheelUp=Utils.createBitmap("wheelUp_png"),this.wheelUp.x=179,this.wheelUp.y=573,this.addChild(this.wheelUp),this.textField=new egret.TextField,this.textField.x=179,this.textField.y=626,this.textField.width=290,this.textField.textAlign="center",this.textField.text="0%",this.textField.bold=!0,this.textField.italic=!0,this.textField.textColor=16704573,this.textField.size=32,this.addChild(this.textField)},n.setProgress=function(t,e){var i=251,n=179;this.wheelUp.x=n+i*(t/e),this.textField.text=Math.floor(t/e*100)+"%"},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onAddToStage=function(t){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},n.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("loading"),RES.loadGroup("preload")},n.onResourceLoadComplete=function(t){"loading"==t.groupName&&(this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView)),"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},n.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},n.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},n.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},n.createGameScene=function(){this.game=new Game,this.addChild(this.game)},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var Mango=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.getAssetName=function(){var t=Utils.random(0,1);return t?"fruit3_png":"fruit4_png"},n.disappear=function(){this.parent.parent.removeMissile(this)},e}(Missile);egret.registerClass(Mango,"Mango");var NoGiftPanel=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight;this._panel=new egret.Sprite;var i=Utils.createBitmap("panel_png");this._panel.addChild(i),this._panel.x=(t-this._panel.width)/2,this._panel.y=(e-this._panel.height)/2,this.addChild(this._panel);var n=new egret.TextField;n.bold=!0,n.textColor=16777215,n.size=36,n.text="很遗憾\r\n您没有中到奖券!",n.textAlign="center",n.width=464,n.y=180,n.lineSpacing=30,n.fontFamily="Microsoft YaHei",this._panel.addChild(n),this.graphics.beginFill(0,.67),this.graphics.drawRect(0,0,t,e),this.graphics.endFill();var s=new egret.Sprite,a=Utils.createBitmap("playAgin_png");s.addChild(a),s.x=76,s.y=402,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playAgain,this),this._panel.addChild(s),this.touchEnabled=!0},n.playAgain=function(){this.dispatchEventWith("playAgain"),this.close()},n.close=function(){this.parent.removeChild(this)},e}(egret.Sprite);egret.registerClass(NoGiftPanel,"NoGiftPanel");var OperationPanel=function(t){function e(){t.call(this),this.speed=300,this.createView(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){this.ctrlLeft=new egret.Sprite,this.ctrlLeft.addChild(Utils.createBitmap("btn1_jpg")),this.ctrlLeft.x=24,this.ctrlLeft.y=281,this.ctrlLeft.touchEnabled=!0,this.ctrlLeft.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLeft,this),this.addChild(this.ctrlLeft),this.ctrlCenter=new egret.Sprite,this.ctrlCenter.addChild(Utils.createBitmap("btn2_jpg")),this.ctrlCenter.x=256,this.ctrlCenter.y=281,this.ctrlCenter.touchEnabled=!0,this.ctrlCenter.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCenter,this),this.addChild(this.ctrlCenter),this.ctrlRight=new egret.Sprite,this.ctrlRight.addChild(Utils.createBitmap("btn3_jpg")),this.ctrlRight.x=481,this.ctrlRight.y=281,this.ctrlRight.touchEnabled=!0,this.ctrlRight.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRight,this),this.addChild(this.ctrlRight),this.track=new Track,this.track.x=(640-this.track.width)/2,this.track.y=50,this.addChild(this.track),this.handLeft=new egret.Sprite,this.handLeft.addChild(Utils.createBitmap("handLeft_png")),this.handLeft.x=-518,this.addChild(this.handLeft),this.handRight=new egret.Sprite,this.handRight.addChild(Utils.createBitmap("handRight_png")),this.handRight.x=578,this.addChild(this.handRight)},n.addToStage=function(){this.y=this.stage.stageHeight-this.height},n.resetHands=function(){egret.Tween.removeTweens(this.handLeft),egret.Tween.removeTweens(this.handRight),this.handLeft.x=-518,this.handRight.x=578},n.onLeft=function(){this["static"]!=e.STATIC_CATCH&&(this.position=e.POSITION_LEFT,this.resetHands(),egret.Tween.get(this.handRight).to({x:this.handRight.x-416},208/258*this.speed).call(function(){egret.Tween.get(this.handLeft,{onChange:this.handLeftMove,onChangeObj:this}).to({x:this.handLeft.x+50},50/258*this.speed).call(function(){egret.Tween.get(this.handLeft).to({x:this.handLeft.x-50},50/258*this.speed)},this),egret.Tween.get(this.handRight,{onChange:this.handRightMove,onChangeObj:this}).to({x:this.handRight.x-50},50/258*this.speed).call(function(){egret.Tween.get(this.handRight).to({x:this.handRight.x+466},233/258*this.speed)},this)},this))},n.onCenter=function(){this["static"]!=e.STATIC_CATCH&&(this.position=e.POSITION_CENTER,this.resetHands(),egret.Tween.get(this.handLeft,{onChange:this.handLeftMove,onChangeObj:this}).to({x:this.handLeft.x+258},this.speed).call(function(){egret.Tween.get(this.handLeft).to({x:this.handLeft.x-258},this.speed)},this),egret.Tween.get(this.handRight,{onChange:this.handRightMove,onChangeObj:this}).to({x:this.handRight.x-258},this.speed).call(function(){egret.Tween.get(this.handRight).to({x:this.handRight.x+258},this.speed)},this))},n.onRight=function(){this["static"]!=e.STATIC_CATCH&&(this.position=e.POSITION_RIGHT,this.resetHands(),egret.Tween.get(this.handLeft).to({x:this.handLeft.x+416},208/258*this.speed).call(function(){egret.Tween.get(this.handLeft,{onChange:this.handLeftMove,onChangeObj:this}).to({x:this.handLeft.x+50},50/258*this.speed).call(function(){egret.Tween.get(this.handLeft).to({x:this.handLeft.x-466},233/258*this.speed)},this),egret.Tween.get(this.handRight,{onChange:this.handRightMove,onChangeObj:this}).to({x:this.handRight.x-50},50/258*this.speed).call(function(){egret.Tween.get(this.handRight).to({x:this.handRight.x+50},50/258*this.speed)},this)},this))},n.handLeftMove=function(){if(this["static"]!=e.STATIC_CATCH)for(var t=this.handLeft.x+580,i=this.localToGlobal(0,19).y,n=this.parent.getExport().getMissilePool(),s=0;s<n.length;s++){var a=n[s];this.fitPosition(a.x)&&a.y+a.height/2>i&&a.y-a.height/2<i+87-a.height&&a.x<=t&&t-a.x<30&&(egret.Tween.pauseTweens(a),egret.Tween.pauseTweens(this.handLeft),a.catchLeft=!0,a.catchRight?this["catch"](a):this.setCatchOneHandTimeout(a))}},n.handRightMove=function(){if(this["static"]!=e.STATIC_CATCH)for(var t=this.handRight.x,i=this.localToGlobal(0,19).y,n=this.parent.getExport().getMissilePool(),s=0;s<n.length;s++){var a=n[s];this.fitPosition(a.x)&&a.y+a.height/2>i&&a.y-a.height/2<i+87-a.height&&a.x+a.width>=t&&a.x+a.width-t<30&&(egret.Tween.pauseTweens(a),egret.Tween.pauseTweens(this.handRight),a.catchRight=!0,a.catchLeft?this["catch"](a):this.setCatchOneHandTimeout(a))}},n.setCatchOneHandTimeout=function(t){var i=this;this.catchOneHandTimeout=setTimeout(function(){i["static"]=e.STATIC_CATCH,i.freeMissile(t)},500)},n.freeMissile=function(t,i){void 0===i&&(i=!1),i?egret.Tween.removeTweens(t):egret.Tween.resumeTweens(t),egret.Tween.resumeTweens(this.handLeft),egret.Tween.resumeTweens(this.handRight);var n=this;setTimeout(function(){n["static"]=e.STATIC_NORMAL},500)},n["catch"]=function(t){clearTimeout(this.catchOneHandTimeout),this["static"]=e.STATIC_CATCH;var i=this;t instanceof Mango&&this.track.addGum(this.position,t,function(){i.dispatchEventWith("add"),i.freeMissile(t,!0)}),t instanceof Grape&&setTimeout(function(){i.freeMissile(t)},500),t instanceof Bomb&&(i.freeMissile(t),this.dispatchEventWith("gameover"))},n.fitPosition=function(t){return this.position==e.POSITION_LEFT&&t>210?!1:this.position==e.POSITION_CENTER&&(210>t||t>430)?!1:this.position==e.POSITION_RIGHT&&430>t?!1:!0},e.POSITION_LEFT=0,e.POSITION_CENTER=1,e.POSITION_RIGHT=2,e.STATIC_NORMAL=0,e.STATIC_CATCH=1,e}(egret.Sprite);egret.registerClass(OperationPanel,"OperationPanel");var RulePanel=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight;this._panel=new egret.Sprite;var i=Utils.createBitmap("rulePanel_png");this._panel.addChild(i),this._panel.x=(t-this._panel.width)/2,this._panel.y=(e-this._panel.height)/2,this.addChild(this._panel);var n=Utils.createBitmap("ruleText_png");n.x=68,n.y=55,this._panel.addChild(n),this.graphics.beginFill(0,.67),this.graphics.drawRect(0,0,t,e),this.graphics.endFill();var s=new egret.Sprite,a=Utils.createBitmap("beginGame_png");s.addChild(a),s.x=154,s.y=598,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this),this._panel.addChild(s),this.touchEnabled=!0},n.close=function(){this.parent.removeChild(this),this.dispatchEventWith("closeRule")},e}(egret.Sprite);egret.registerClass(RulePanel,"RulePanel");var ShareFriend=function(){function t(){this.loader=new egret.URLLoader}var e=(__define,t);e.prototype;return t}();egret.registerClass(ShareFriend,"ShareFriend");var SharePanel=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight;this._panel=new egret.Sprite;var i=Utils.createBitmap("shareText_png");this._panel.addChild(i),this._panel.x=380,this._panel.y=35,this.addChild(this._panel),this.graphics.beginFill(0,.67),this.graphics.drawRect(0,0,t,e),this.graphics.endFill(),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this)},n.close=function(){this.parent.removeChild(this)},e}(egret.Sprite);egret.registerClass(SharePanel,"SharePanel");var Spinner=function(t){function e(){t.call(this),this.create(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.show,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.instance=function(){return null==this._instance&&(this._instance=new e),this._instance},n.create=function(){var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight,i=RES.getRes("spinner_json"),n=RES.getRes("spinner_png"),s=new egret.MovieClipDataFactory(i,n);this._mc=new egret.MovieClip(s.generateMovieClipData("spinner")),this._mc.x=(t-this._mc.width)/2,this._mc.y=(e-this._mc.height)/2,this.addChild(this._mc),this.graphics.beginFill(0,.67),this.graphics.drawRect(0,0,t,e),this.graphics.endFill(),this.touchEnabled=!0},n.show=function(){this._mc.play(-1)},e}(egret.Sprite);egret.registerClass(Spinner,"Spinner");var TimeupPanel=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight;this._panel=new egret.Sprite;var i=Utils.createBitmap("panel_png");this._panel.addChild(i),this._panel.x=(t-this._panel.width)/2,this._panel.y=(e-this._panel.height)/2,this.addChild(this._panel);var n=Utils.createBitmap("timeup_png");n.x=60,n.y=77,this._panel.addChild(n),this.tip=Utils.createBitmap("timeupTip_png"),this.tip.x=60,this.tip.y=362,this.graphics.beginFill(0,.67),this.graphics.drawRect(0,0,t,e),this.graphics.endFill();var s=new egret.Sprite,a=Utils.createBitmap("playAgin_png");s.addChild(a),s.x=76,s.y=402,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playAgain,this),this._panel.addChild(s),this.getGiftBtn=new egret.Sprite;var h=Utils.createBitmap("getGift_png");this.getGiftBtn.addChild(h),this.getGiftBtn.x=76,this.getGiftBtn.y=475,this.getGiftBtn.touchEnabled=!0,this.getGiftBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getGift,this),this.touchEnabled=!0,this.result=new egret.TextField,this.result.bold=!0,this.result.textColor=15188536,this.result.size=48,this.result.x=250,this.result.y=300,this.result.width=60,this.result.textAlign="center",this._panel.addChild(this.result)},n.playAgain=function(){this.dispatchEventWith("playAgain"),this.close()},n.getGift=function(){this.dispatchEventWith("getGift")},n.close=function(){this.parent.removeChild(this)},n.setResult=function(t){this.result.text=t,t>=5?(this._panel.contains(this.getGiftBtn)||this._panel.addChild(this.getGiftBtn),this._panel.contains(this.tip)&&this._panel.removeChild(this.tip)):(this._panel.contains(this.getGiftBtn)&&this._panel.removeChild(this.getGiftBtn),this._panel.contains(this.tip)||this._panel.addChild(this.tip))},e}(egret.Sprite);egret.registerClass(TimeupPanel,"TimeupPanel");var Track=function(t){function e(){t.call(this),this.status=e.STATUS_CENTER,this.speed=400,this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){var t=Utils.createBitmap("track_png");t.y=133,this.addChild(t),this.boxBack=Utils.createBitmap("boxBack_png"),this.boxBack.x=(this.width-this.boxBack.width)/2,this.boxBack.y=83,this.addChild(this.boxBack),this.gumLayer=new egret.Sprite,this.addChild(this.gumLayer),this.boxFront=Utils.createBitmap("boxFront_png"),this.boxFront.x=(this.width-this.boxFront.width)/2,this.boxFront.y=83,this.addChild(this.boxFront)},n.moveLeft=function(t){return this.status==e.STATUS_LEFT?void t.apply(this):(this.status=e.STATUS_LEFT,void egret.Tween.get(this).to({x:-460},this.speed).call(t,this))},n.moveCenter=function(t){return this.status==e.STATUS_CENTER?void t.apply(this):(this.status=e.STATUS_CENTER,void egret.Tween.get(this).to({x:-252.5},this.speed).call(t,this))},n.moveRight=function(t){return this.status==e.STATUS_RIGHT?void t.apply(this):(this.status=e.STATUS_RIGHT,void egret.Tween.get(this).to({x:-42},this.speed).call(t,this))},n.addGum=function(t,e,i){var n=Utils.createBitmap("gum_png"),s=function(){e.disappear(),this.gumLayer.addChild(n),egret.Tween.get(n).to({y:133},this.speed).call(function(){this.gumLayer.removeChild(n),i()},this)};t==OperationPanel.POSITION_LEFT?(n.x=552,this.moveLeft(s)):t==OperationPanel.POSITION_CENTER?(n.x=545,this.moveCenter(s)):t==OperationPanel.POSITION_RIGHT&&(n.x=557,this.moveRight(s))},e.STATUS_LEFT=0,e.STATUS_CENTER=1,e.STATUS_RIGHT=2,e}(egret.Sprite);egret.registerClass(Track,"Track");var Utils=function(){function t(){}var e=(__define,t);e.prototype;return t.createBitmap=function(t){var e=new egret.Bitmap;return e.texture=RES.getRes(t),e},t.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t.hitTest=function(t,e){var i=t.getBounds(),n=e.getBounds(),s=t.localToGlobal(0,0);i.x=s.x,i.y=s.y;var a=e.localToGlobal(0,0);return n.x=a.x,n.y=a.y,i.intersects(n)},t}();egret.registerClass(Utils,"Utils");var WechatGiftPanel=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){var t=egret.MainContext.instance.stage.stageWidth,e=egret.MainContext.instance.stage.stageHeight;this._panel=new egret.Sprite;var i=Utils.createBitmap("panel_png");this._panel.addChild(i),this._panel.x=(t-this._panel.width)/2,this._panel.y=(e-this._panel.height)/2,this.addChild(this._panel);var n=new egret.TextField;n.bold=!0,n.textColor=16777215,n.size=36,n.text="恭喜你！",n.textAlign="center",n.width=464,n.y=90,n.fontFamily="Microsoft YaHei",this._panel.addChild(n);var s=new egret.TextField;s.bold=!0,s.textColor=16777215,s.size=24,s.textAlign="center",s.text="获得炫小迈提供的\r\n优惠券一份快来感受\r\n持久果味吧！\r\n请保存在微信卡包\r\n使用规则详见卡券说明",s.width=464,s.y=160,s.lineSpacing=20,s.fontFamily="Microsoft YaHei",this._panel.addChild(s),this.graphics.beginFill(0,.67),this.graphics.drawRect(0,0,t,e),this.graphics.endFill();var a=new egret.Sprite,h=Utils.createBitmap("getTicket_png");a.addChild(h),a.x=76,a.y=402,a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getTicket,this),this._panel.addChild(a);var r=new egret.Sprite,h=Utils.createBitmap("playAgin2_png");r.addChild(h),r.x=76,r.y=475,r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playAgain,this),this._panel.addChild(r),this.touchEnabled=!0},n.playAgain=function(){this.dispatchEventWith("playAgain"),this.close()},n.getTicket=function(){this.dispatchEventWith("getTicket")},n.close=function(){this.parent.removeChild(this)},e}(egret.Sprite);egret.registerClass(WechatGiftPanel,"WechatGiftPanel");